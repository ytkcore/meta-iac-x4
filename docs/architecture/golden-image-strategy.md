# 아키텍처: 골든 이미지(Golden Image) 전략

## 개요
불변 인프라(Immutable Infrastructure) 및 폐쇄망(Air-gapped) 환경의 보안 요구사항을 충족하기 위해, 프로젝트에서는 "골든 이미지" 패턴을 사용합니다. 사용자 데이터(User Data)를 통해 런타임에 소프트웨어를 설치(인터넷 연결 필요)하는 대신, 필요한 모든 의존성이 미리 설치된 사용자 지정 AMI(Amazon Machine Image)를 미리 구축하여 사용합니다.

## 전략
- **도구**: HashiCorp Packer를 사용하여 AMI 생성 프로세스를 자동화합니다.
- **기본 OS**: Amazon Linux 2023 (AL2023).
- **자동화**: `make init` 워크플로우에 통합하여 인프라 프로비저닝 전 유효한 AMI가 존재하는지 보장합니다.

## 이미지 구성 요소
표준 골든 이미지에는 다음이 포함됩니다:
1. **컨테이너 런타임**: Docker Engine (사전 설치 및 활성화).
2. **오케스트레이션 도구**: Docker Compose.
3. **AWS 통합**: SSM Agent (키리스 관리용), AWS CLI v2.
4. **보안**: 강화된 OS 설정 및 필수 보안 에이전트.

## 워크플로우
1. **트리거**: `make init` 실행 시 `Role: meta-golden-image` 태그가 붙은 최신 AMI를 확인합니다.
2. **빌드**: 이미지가 없는 경우, Packer가 임시 인스턴스를 실행하고 프로비저닝을 수행하여 새로운 AMI를 생성합니다.
3. **사용**: Terraform 스택은 Data Source를 사용하여 최신 골든 이미지 ID를 조회합니다.

## 기대 효과
- **보안**: 격리된 서브넷에서 부팅 시 외부 인터넷 의존성 제거.
- **속도**: 인스턴스 시작 시간 획기적 단축 (설치 과정 생략).
- **일관성**: 모든 환경(개발/스테이징/운영)에서 동일한 운영 환경 보장.
